<!DOCTYPE html>
<!-- saved from url=(0042)https://curiosity-driven.org/sudoku-solver -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, user-scalable=no"><meta name="description" content="Solving sudoku using the backtracking algorithm. Uses ES6 generators to create a stream of possible solutions."><meta name="referrer" content="always"><title>Sudoku solver</title><link rel="stylesheet" href="https://curiosity-driven.org/assets/38d9f92af9e0784c708bb3a47412b8e1e02b075a/styles"><link rel="stylesheet" href="https://curiosity-driven.org/assets/2958a2e9f2a77cec255e8b99e4d49c6e53f927f0/board"><link rel="stylesheet" href="https://curiosity-driven.org/assets/b8fc75c3c6181a5dfbd8b994969603642d70790e/codemirror-styles"><link rel="alternate" type="application/atom+xml" href="https://curiosity-driven.org/" title="Atom feed"><style type="text/css"></style></head><body><div class="links"><a href="https://curiosity-driven.org/" title="All articles">«</a> <a href="https://curiosity-driven.org/sudoku-solver#" class="review" title="Annotations"></a> <a href="https://curiosity-driven.org/" class="feed" title="Feed"></a> <a href="https://curiosity-driven.org/sudoku-solver#" class="top" title="Scroll to top">↑</a></div><h1 data-name="p0">Sudoku solver</h1><time datetime="2014-02-06">6<sup>th</sup> February 2014</time><main><p data-name="p1">Solving <a href="https://en.wikipedia.org/wiki/Sudoku">sudoku</a> using the <a href="https://en.wikipedia.org/wiki/Backtracking">backtracking</a> algorithm. Uses ES6 generators to create a stream of possible solutions.</p><p data-name="p2">The <code>generateBoards</code> generator below creates all possible boards given the initial configuration. Then after filtering out invalid configurations (<code>isPartialSolutionCorrect</code>) the board is reported as a possible solution (<code>yield board</code>). All possible extensions of that board are also explored (<code>yield* generateSolutions(board)</code>).</p><p data-name="p3">Chrome supports both ES6 generators and <code>Set</code>s but it's necessary to enable Experimental JavaScript at <code>chrome://flags/#enable-javascript-harmony</code>. Firefox supports generators as well as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">Sets</a>.</p><section><p data-name="p5">To run the example your browser has to support:</p><ul class="checks"><li data-name="p6" data-check="(function*() { yield 2; })" class="success">ES6 generators</li><li data-name="p7" data-check="for(var i of (function*() { yield 2; })() ) { }; true" class="success">for-of loops</li><li data-name="p8" data-check="&#39;Set&#39; in window" class="success">ES6 Sets</li></ul><input type="button" value="Execute code below" class="run"><textarea id="board">. 6 . 3 . . 8 . 4
5 3 7 . 9 . . . .
. 4 . . . 6 3 . 7
. 9 . . 5 1 2 3 8
. . . . . . . . .
7 1 3 6 2 . . 4 .
3 . 6 4 . . . 1 .
. . . . 6 . 5 2 3
1 . 2 . . 9 . 8 .</textarea><div>Partial solutions found: <span id="partial">187</span></div><div>Complete solutions found: <span id="complete">8</span></div><div>Status: <span id="status">Started</span></div><input type="button" value="Start" id="start" disabled=""><input type="button" value="Stop" id="stop"><input type="button" value="Reset" id="reset"><pre hidden=""><code>

function print(board) {
    function elementToCharacter(element) {
        return element === 0 ? '.' : element;
    }
    function getLine(row) {
        return row.map(elementToCharacter).join(' ');
    }
    var text = board.map(getLine).join('\n');
    document.getElementById('board').value = text;
}

function parse(text) {
    function parseCharacter(character) {
        return parseInt(character, 10) || 0;
    }
    function parseLine(line) {
        return line.split(' ').map(parseCharacter);
    }
    return text.split('\n').map(parseLine);
}

var partialElement = document.getElementById('partial');
var completeElement = document.getElementById('complete');
var statusElement = document.getElementById('status');

var startButton = document.getElementById('start');
var stopButton = document.getElementById('stop');

var handle;

startButton.onclick = function() {
    var board = parse(document.getElementById('board').value);
    var boards = generateSolutions(board);
    var partial = 0, complete = 0;

    function printNextSolution() {
        var result = boards.next();
        if (!result.done) {
            var solution = result.value;
            print(solution);
            partial++;
            if (isCompleteSolution(solution)) {
                complete++;
            }
            partialElement.textContent = partial;
            completeElement.textContent = complete;
            handle = setTimeout(printNextSolution, 200);
        } else {
            startButton.disabled = false;
            stopButton.disabled = true;
            statusElement.textContent = 'No more solutions';
        }
    }

    handle = setTimeout(printNextSolution, 200);
    startButton.disabled = true;
    stopButton.disabled = false;
    statusElement.textContent = 'Started';
    partialElement.textContent = partial;
    completeElement.textContent = complete;
};

stopButton.onclick = function() {
    clearTimeout(handle);
    startButton.disabled = false;
    stopButton.disabled = true;
    statusElement.textContent = 'Stopped';
};

document.getElementById('reset').onclick = function() {
    document.getElementById('board').value = '. 6 . 3 . . 8 . 4\n'+
'5 3 7 . 9 . . . .\n'+
'. 4 . . . 6 3 . 7\n'+
'. 9 . . 5 1 2 3 8\n'+
'. . . . . . . . .\n'+
'7 1 3 6 2 . . 4 .\n'+
'3 . 6 4 . . . 1 .\n'+
'. . . . 6 . 5 2 3\n'+
'1 . 2 . . 9 . 8 .';
};</code></pre><pre><div class="CodeMirror cm-s-default"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 4px; left: 4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none; font-size: 4px;" tabindex="0"></textarea></div><div class="CodeMirror-hscrollbar" style="left: 0px; right: 0px; min-height: 18px; pointer-events: none;"><div style="height: 1px; width: 0px;"></div></div><div class="CodeMirror-vscrollbar" style="min-width: 18px; pointer-events: none;"><div style="width: 1px; height: 0px;"></div></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="min-width: 591.8800048828125px; margin-left: 0px; min-height: 1453px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><div style="width: 50px; height: 50px; overflow-x: scroll;"></div></div><div style="position: relative; z-index: 1; display: none;"></div><div class="CodeMirror-code" style=""><pre><span class="cm-keyword">function*</span> <span class="cm-variable">generateSolutions</span>(<span class="cm-def">board</span>) {</pre><pre>    <span class="cm-comment">// copy board as it is modified inside this function</span></pre><pre>    <span class="cm-keyword">var</span> <span class="cm-def">board</span> <span class="cm-operator">=</span> <span class="cm-variable">JSON</span>.<span class="cm-property">parse</span>(<span class="cm-variable">JSON</span>.<span class="cm-property">stringify</span>(<span class="cm-variable-2">board</span>));</pre><pre>&nbsp;</pre><pre>    <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">suggestion</span> <span class="cm-keyword">of</span> <span class="cm-variable">generateBoards</span>(<span class="cm-variable-2">board</span>)) {</pre><pre>        <span class="cm-variable-2">board</span>[<span class="cm-variable-2">suggestion</span>.<span class="cm-property">row</span>][<span class="cm-variable-2">suggestion</span>.<span class="cm-property">column</span>] <span class="cm-operator">=</span> <span class="cm-variable-2">suggestion</span>.<span class="cm-property">value</span>;</pre><pre>&nbsp;</pre><pre>        <span class="cm-keyword">if</span> (<span class="cm-variable">isPartialSolutionCorrect</span>(<span class="cm-variable-2">board</span>)) {</pre><pre>            <span class="cm-keyword">yield</span> <span class="cm-variable-2">board</span>;</pre><pre>            <span class="cm-keyword">yield</span><span class="cm-operator">*</span> <span class="cm-variable">generateSolutions</span>(<span class="cm-variable-2">board</span>);</pre><pre>        }</pre><pre>    }</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function*</span> <span class="cm-variable">generateBoards</span>(<span class="cm-def">board</span>) {</pre><pre>    <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">i</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">i</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">board</span>.<span class="cm-property">length</span>; <span class="cm-variable-2">i</span><span class="cm-operator">++</span>) {</pre><pre>        <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">j</span> <span class="cm-operator">=</span> <span class="cm-number">0</span>; <span class="cm-variable-2">j</span> <span class="cm-operator">&lt;</span> <span class="cm-variable-2">board</span>[<span class="cm-variable-2">i</span>].<span class="cm-property">length</span>; <span class="cm-variable-2">j</span><span class="cm-operator">++</span>) {</pre><pre>            <span class="cm-keyword">if</span> (<span class="cm-variable-2">board</span>[<span class="cm-variable-2">i</span>][<span class="cm-variable-2">j</span>] <span class="cm-operator">===</span> <span class="cm-number">0</span>) {</pre><pre>                <span class="cm-keyword">for</span> (<span class="cm-keyword">var</span> <span class="cm-def">k</span> <span class="cm-operator">=</span> <span class="cm-number">1</span>; <span class="cm-variable-2">k</span> <span class="cm-operator">&lt;=</span> <span class="cm-number">9</span>; <span class="cm-variable-2">k</span><span class="cm-operator">++</span>) {</pre><pre>                    <span class="cm-keyword">yield</span> { <span class="cm-property">row</span>: <span class="cm-variable-2">i</span>, <span class="cm-property">column</span>: <span class="cm-variable-2">j</span>, <span class="cm-property">value</span>: <span class="cm-variable-2">k</span> };</pre><pre>                }</pre><pre>            }</pre><pre>        }</pre><pre>    }</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">isPartialSolutionCorrect</span>(<span class="cm-def">board</span>) {</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">checkRows</span>(<span class="cm-variable-2">board</span>) <span class="cm-operator">&amp;&amp;</span> <span class="cm-variable">checkRows</span>(<span class="cm-variable">zip</span>(<span class="cm-variable-2">board</span>)) <span class="cm-operator">&amp;&amp;</span></pre><pre>        <span class="cm-variable">checkGroups</span>(<span class="cm-variable-2">board</span>);</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">isCompleteSolution</span>(<span class="cm-def">board</span>) {</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable-2">board</span>.<span class="cm-property">every</span>(<span class="cm-keyword">function</span>(<span class="cm-def">row</span>) {</pre><pre>        <span class="cm-keyword">return</span> <span class="cm-variable-2">row</span>.<span class="cm-property">every</span>(<span class="cm-variable">isTruthy</span>);</pre><pre>    });</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">checkRows</span>(<span class="cm-def">row</span>) {</pre><pre>  <span class="cm-keyword">return</span> <span class="cm-variable-2">row</span>.<span class="cm-property">every</span>(<span class="cm-variable">noDuplicates</span>);</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">checkGroups</span>(<span class="cm-def">board</span>) {</pre><pre>    <span class="cm-keyword">function</span> <span class="cm-def">checkGroup</span>(<span class="cm-def">group</span>) {</pre><pre>        <span class="cm-keyword">return</span> <span class="cm-variable-2">group</span>.<span class="cm-property">map</span>(<span class="cm-variable">flatten</span>).<span class="cm-property">every</span>(<span class="cm-variable">noDuplicates</span>);</pre><pre>    }</pre><pre>    <span class="cm-keyword">var</span> <span class="cm-def">partitionByThree</span> <span class="cm-operator">=</span> <span class="cm-variable">partition</span>.<span class="cm-property">bind</span>(<span class="cm-atom">null</span>, <span class="cm-number">3</span>);</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">zip</span>(<span class="cm-variable-2">board</span>.<span class="cm-property">map</span>(<span class="cm-variable-2">partitionByThree</span>)).<span class="cm-property">map</span>(<span class="cm-variable-2">partitionByThree</span>)</pre><pre>        .<span class="cm-property">map</span>(<span class="cm-variable-2">checkGroup</span>).<span class="cm-property">every</span>(<span class="cm-variable">isTruthy</span>);</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">noDuplicates</span>(<span class="cm-def">array</span>) {</pre><pre>    <span class="cm-keyword">var</span> <span class="cm-def">filtered</span> <span class="cm-operator">=</span> <span class="cm-variable-2">array</span>.<span class="cm-property">filter</span>(<span class="cm-variable">isTruthy</span>);</pre><pre>    <span class="cm-comment">// new Set([1,2,3]) does not work in Chrome but works in Firefox</span></pre><pre>    <span class="cm-keyword">var</span> <span class="cm-def">set</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Set</span>();</pre><pre>    <span class="cm-variable-2">filtered</span>.<span class="cm-property">forEach</span>(<span class="cm-keyword">function</span>(<span class="cm-def">element</span>) {</pre><pre>        <span class="cm-variable-2">set</span>.<span class="cm-property">add</span>(<span class="cm-variable-2">element</span>);</pre><pre>    });</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable-2">filtered</span>.<span class="cm-property">length</span> <span class="cm-operator">===</span> <span class="cm-variable-2">set</span>.<span class="cm-property">size</span>;</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">zip</span>(<span class="cm-def">arrays</span>) {</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable-2">arrays</span>[<span class="cm-number">0</span>].<span class="cm-property">map</span>(<span class="cm-keyword">function</span>(<span class="cm-def">element</span>, <span class="cm-def">index</span>){</pre><pre>        <span class="cm-keyword">return</span> <span class="cm-variable-2">arrays</span>.<span class="cm-property">map</span>(<span class="cm-keyword">function</span>(<span class="cm-def">array</span>) {</pre><pre>            <span class="cm-keyword">return</span> <span class="cm-variable-2">array</span>[<span class="cm-variable-2">index</span>];</pre><pre>        });</pre><pre>    });</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">partition</span>(<span class="cm-def">chunkSize</span>, <span class="cm-def">array</span>) {</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">flatten</span>(<span class="cm-variable-2">array</span>.<span class="cm-property">map</span>(<span class="cm-keyword">function</span>(<span class="cm-def">element</span>, <span class="cm-def">index</span>) {</pre><pre>        <span class="cm-keyword">if</span> (<span class="cm-variable-2">index</span> <span class="cm-operator">%</span> <span class="cm-variable-2">chunkSize</span>) {</pre><pre>            <span class="cm-keyword">return</span> [];</pre><pre>        } <span class="cm-keyword">else</span> {</pre><pre>            <span class="cm-keyword">return</span> [ <span class="cm-variable-2">array</span>.<span class="cm-property">slice</span>(<span class="cm-variable-2">index</span>, <span class="cm-variable-2">index</span> <span class="cm-operator">+</span> <span class="cm-variable-2">chunkSize</span>) ];</pre><pre>        }</pre><pre>    }));</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">flatten</span>(<span class="cm-def">array</span>) {</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-variable">Array</span>.<span class="cm-property">prototype</span>.<span class="cm-property">concat</span>.<span class="cm-property">apply</span>([], <span class="cm-variable-2">array</span>);</pre><pre>}</pre><pre>&nbsp;</pre><pre><span class="cm-keyword">function</span> <span class="cm-variable">isTruthy</span>(<span class="cm-def">value</span>) {</pre><pre>    <span class="cm-keyword">return</span> <span class="cm-operator">!!</span><span class="cm-variable-2">value</span>;</pre><pre>}</pre></div><div class="CodeMirror-cursor" style="left: 4px; top: 0px; height: 16px;">&nbsp;</div><div class="CodeMirror-cursor CodeMirror-secondarycursor" style="display: none;">&nbsp;</div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 1453px;"></div><div class="CodeMirror-gutters" style="display: none; height: 1453px;"></div></div></div></pre><pre class="finalize" hidden=""><code>startButton.onclick();</code></pre></section></main><nav><header>Further reading</header><div><a href="https://curiosity-driven.org/private-properties-in-javascript"><p class="header-link">Private properties in JavaScript</p><p>Object properties were traditionally left unprotected in JavaScript or hidden, captured in a closure. Symbols and WeakMaps provide another alternative.</p></a></div><div><a href="https://curiosity-driven.org/monads-in-javascript"><p class="header-link">Monads in JavaScript</p><p>Monad is a design pattern used to describe computations as a series of steps. They are extensively used in pure functional programming languages to manage side effects but can also be used in multiparadigm languages to control complexity.</p></a></div><a href="https://curiosity-driven.org/">See more...</a></nav><footer><p>Content of this page is licensed under the <a href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 License</a>.</p><p>Code samples are licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>.</p></footer><script src="javascript-live" charset="utf-8" async=""></script></body></html>
